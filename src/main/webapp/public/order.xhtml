<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:jsf="http://xmlns.jcp.org/jsf">
<h:head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta http-equiv="X-UA-Conpatible" content="IE=edge" />
	<h:outputStylesheet library="css" name="bootstrap.min.css"/>
		<h:outputStylesheet library="css" name="style.css"/>
	<script>
	 $('#scrollable-dropdown-menu .typeahead').typeahead(null, {
		  name: 'client',
		  limit: 10,
		  source: client
		});
     </script>
	<title>Demo Web</title>
</h:head>
<h:body>
	<div class="container">
		<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed"
					data-toggle="collapse" data-target="#navbar" aria-expanded="false"
					aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">Web Dev Academy</a>
			</div>
			<div id="navbar" class="navbar-collapse collapse">
				<ul class="nav navbar-nav navbar-right">
					<li><a href="#">In&iacute;cio</a></li>
					<li><a href="#">Op&ccedil;&otilde;es</a></li>
					<li><a href="#">Perfil</a></li>
					<li><a href="#">Ajuda</a></li>
				</ul>
			</div>
		</div>
		</nav>

		<div id="main" class="container-fluid">

			<h3 class="page-header">Adicionar Item</h3>

			<div class="col-xs-12">
				<h:form styleClass="form-horizontal">

					<div class="panel panel-default">
						<div class="panel panel-heading">
							<h:outputText id="titulo" value="Dados do Pedido"
								style="font-weight: bold;" />
						</div>
						<div class="form-group">
							<h:outputLabel value="Cliente"
								styleClass="control-label col-sm-2" />
							<div id="scrollable-dropdown-menu">
								<h:inputText id="client" class="typeahead" type="text" placeholder="Cliente"
									value="#{orderController.order.client}" />
							</div>
						</div>

						<div class="form-group">
							<div class="col-md-12">

								<h:commandButton action="#{orderController.save}" value="Novo"
									class="btn btn-success" />


							</div>

						</div>

						<div class="form-group">
							<h:outputLabel value="Cerimonial"
								styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:selectOneMenu id="ceremonial" filter="true"
									value="#{orderController.order.ceremonial}"
									converter="#{ceremonialConverter}" required="true"
									requiredMessage="O campo 'Cerimonial' é obrigatório">
									<f:selectItem noSelectionOption="true"
										itemLabel=".:Selecione um cerimonial:." />
									<f:selectItems value="#{orderController.ceremonials}" var="ce"
										itemValue="#{ce}" itemLabel="#{ce.nome}" />
								</h:selectOneMenu>
							</div>
						</div>


						<div class="form-group">
							<h:outputLabel id="pedidoLabel" value="Data do Pedido:"
								styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText id="datapedido" p:type="date"
									value="#{orderController.order.dataPedido}">
									<f:convertDateTime pattern="yyyy-MM-dd" />
								</h:inputText>
							</div>
						</div>

						<div class="form-group">
							<h:outputLabel id="entregaLabel" value="Data da Entrega:"
								styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText id="entrega" p:type="date"
									value="#{orderController.order.dataEntrega}">
									<f:convertDateTime pattern="yyyy-MM-dd" />
								</h:inputText>
							</div>
						</div>

						<div class="form-group">
							<h:outputLabel id="valorLabel" value="Valor:"
								styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText value="#{orderController.order.valorTotal}">
									<f:convertNumber minFractionDigits="2" />
								</h:inputText>
							</div>
						</div>


					</div>

					<div class="panel panel-default">
						<div class="panel panel-heading">
							<h:outputText id="titulo1" value="Endereço Entrega"
								style="font-weight: bold;" />
						</div>

						<div class="form-group">
							<h:outputLabel value="Logradouro"
								styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText
									value="#{orderController.order.enderecoEntrega.logradouro}"
									styleClass="form-control" />
							</div>
						</div>
						<div class="form-group">
							<h:outputLabel value="Complemento"
								styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText
									value="#{orderController.order.enderecoEntrega.complemento}"
									styleClass="form-control" />
							</div>
						</div>
						<div class="form-group">
							<h:outputLabel value="Bairro" styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText
									value="#{orderController.order.enderecoEntrega.bairro}"
									styleClass="form-control" />
							</div>
						</div>
						<div class="form-group">
							<h:outputLabel value="Numero" styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText
									value="#{orderController.order.enderecoEntrega.numero}"
									styleClass="form-control" />
							</div>
						</div>
						<div class="form-group">
							<h:outputLabel value="CEP" styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText
									value="#{orderController.order.enderecoEntrega.cep}"
									styleClass="form-control" />
							</div>
						</div>

					</div>

					<div class="panel panel-default">
						<div class="panel panel-heading">
							<h:outputText id="titulo2" value="Item Pedido"
								style="font-weight: bold;" />
						</div>
						<div class="panel-body">
							<h:panelGrid id="dados3" columns="6">

								<h:outputLabel for="product" value="Produto:" />
								<h:selectOneMenu id="product" filter="true"
									value="#{orderController.item.product}"
									converter="#{productConverter}" required="true"
									requiredMessage="O campo 'Produto' é obrigatório">
									<f:selectItem noSelectionOption="true"
										itemLabel=".:Selecione um produto:. " />
									<f:selectItems value="#{orderController.products}"
										var="product" itemValue="#{product}"
										itemLabel="#{product.descricao}" />
								</h:selectOneMenu>

								<h:outputLabel for="order" value="Pedido:" />
								<h:selectOneMenu id="order" filter="true"
									value="#{orderController.item.order}"
									converter="#{orderConverter}" required="true"
									requiredMessage="O campo 'Pedido' é obrigatório">
									<f:selectItem noSelectionOption="true"
										itemLabel=".:Selecione um pedido:. " />
									<f:selectItems value="#{orderController.orders}" var="order"
										itemValue="#{order}" itemLabel="#{order.client.nome}" />
								</h:selectOneMenu>

								<h:outputLabel for="embrulho" value="Embrulho:" />
								<h:selectOneMenu id="embrulho" filter="true"
									value="#{orderController.item.embrulho}"
									converter="#{packageConverter}" required="true"
									requiredMessage="O campo 'Embrulho' é obrigatório">
									<f:selectItem noSelectionOption="true"
										itemLabel=".:Selecione um embrulho:. " />
									<f:selectItems value="#{orderController.embrulhos}"
										var="embrulho" itemValue="#{embrulho}"
										itemLabel="#{order.embrulho.descricao}" />
								</h:selectOneMenu>

								<h:outputText value="Valor Produto:" />
								<h:inputText value="#{orderController.item.valorProduto}">

									<f:convertNumber minFractionDigits="2" />
								</h:inputText>

								<h:outputText value="Valor Embrulho:" />
								<h:inputText value="#{orderController.item.valorEmbrulho}">

									<f:convertNumber minFractionDigits="2" />
								</h:inputText>


								<h:outputLabel value="Quantidade"
									styleClass="control-label col-sm-2" />

								<h:inputText value="#{orderController.item.quantidade}"
									styleClass="form-control" />


								<h:commandButton action="#{orderController.adicionarPedido()}"
									value="+" title="Adicionar">
									<f:ajax render="@form" />
								</h:commandButton>

								<table class="table table-bordered table-striped">
									<thead>
										<tr>
											<th>Codigo</th>
											<th>Produto</th>
											<th>Pedido</th>
											<th>ValorProduto</th>
											<th>ValorEmbrulho</th>
											<th>Quantidade</th>
											<th>Ação</th>
										</tr>
									</thead>
									<tbody>
										<ui:repeat var="o" value="#{orderController.order.itens}">
											<tr>
												<td>#{o.id}</td>
												<td>#{o.item.product.descricao}</td>
												<td>#{o.client.nome}</td>
												<td>#{o.item.valorProduto}</td>
												<td>#{o.item.valorEmbrulho}</td>
												<td>#{o.item.quantidade}</td>


												<td><h:form>
														<h:commandButton
															action="#{orderController.excluirPedido(item)}" value="-"
															titulo="Excluir">
															<f:ajax render="@form" />
														</h:commandButton>
													</h:form></td>

											</tr>
										</ui:repeat>
									</tbody>
								</table>



							</h:panelGrid>
						</div>
					</div>


					<div class="panel panel-default">
						<div class="panel panel-heading">
							<h:outputText id="titulo3" value="Pagamento"
								style="font-weight: bold;" />
						</div>

						<div class="form-group">
							<h:outputLabel value="Valor pago"
								styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText value="#{paymentController.payment.valor}"
									styleClass="form-control" />
							</div>
						</div>
						<div class="form-group">
							<h:outputLabel value="Data Pagamento"
								styleClass="control-label col-sm-2" />
							<div class="form-group col-md-4">
								<h:inputText p:type="date" styleClass="form-control"
									value="#{paymentController.payment.dataPagamento}" />
							</div>
						</div>

					</div>


					<div class="form-group">
						<div class="col-md-12">

							<h:commandButton action="#{orderController.save}" value="Salvar"
								class="btn btn-success" />
							<h:commandButton rendered="#{orderController.modoEdicao}"
								action="#{orderController.cancelar}" value="Cancelar"
								styleClass="btn btn-default" />

						</div>

					</div>
				</h:form>

			</div>
		</div>
	</div>
</h:body>
</html>
